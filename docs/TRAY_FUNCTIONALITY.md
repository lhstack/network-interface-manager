# 系统托盘功能

## 功能概述

应用支持最小化到系统托盘，在后台运行。用户可以通过点击系统托盘图标来显示或隐藏应用窗口。

## 工作原理

### 最小化到托盘
1. 用户点击窗口的关闭按钮（X）
2. 应用不会退出，而是最小化到系统托盘
3. 应用窗口从任务栏消失（skipTaskbar: true）
4. 应用继续在后台运行，监控DNS任务

### 从托盘恢复/隐藏
1. **左键点击**系统托盘中的应用图标 → 切换显示/隐藏
   - 如果窗口可见 → 隐藏窗口
   - 如果窗口隐藏 → 显示窗口并获得焦点
2. **右键点击**系统托盘中的应用图标 → 显示菜单

### 托盘菜单
右键点击系统托盘图标会显示菜单：
- **显示**: 显示应用窗口
- **分隔符**: 菜单分隔线
- **退出**: 完全退出应用并关闭进程

## 用户体验

### 场景1：最小化应用
1. 用户点击窗口的关闭按钮
2. 窗口消失，应用最小化到系统托盘
3. 任务栏中不再显示应用图标
4. 应用继续在后台运行

### 场景2：显示应用（左键点击）
1. 用户左键点击系统托盘中的应用图标
2. 应用窗口立即显示并获得焦点
3. 用户可以继续使用应用

### 场景3：隐藏应用（左键点击）
1. 应用窗口正在显示
2. 用户左键点击系统托盘中的应用图标
3. 应用窗口隐藏到托盘
4. 任务栏中不显示应用图标

### 场景4：打开菜单（右键点击）
1. 用户右键点击系统托盘图标
2. 菜单显示，包含"显示"和"退出"选项
3. 用户可以选择相应的操作

### 场景5：退出应用
1. 用户右键点击系统托盘图标
2. 选择"退出"
3. 应用完全退出，进程关闭

## 平台支持

- **Windows**: 完全支持，托盘图标显示在系统托盘中
- **Linux**: 支持（需要系统托盘支持）
- **macOS**: 支持，托盘图标显示在菜单栏中

## 注意事项

1. **后台运行**
   - 应用最小化到托盘后继续运行
   - DNS监控任务继续执行
   - 开机自启功能继续工作

2. **内存使用**
   - 最小化到托盘不会释放内存
   - 应用仍然占用系统资源

3. **通知**
   - 可以在后台显示系统通知
   - 用户可以在不打开窗口的情况下收到通知

4. **多显示器**
   - 应用记住上次的窗口位置
   - 恢复时会在相同位置显示

## 故障排查

### 托盘图标不显示
1. 检查系统托盘是否启用
2. 检查 `tauri.conf.json` 中的托盘配置
3. 检查图标文件是否存在

### 无法从托盘恢复窗口
1. 尝试右键点击托盘图标
2. 选择"显示"菜单项
3. 检查应用是否仍在运行

### 应用在后台消耗过多资源
1. 检查DNS监控是否启用
2. 考虑在最小化时暂停监控
3. 查看应用日志中的错误信息

## 未来改进

1. **系统通知**
   - 在DNS任务执行时显示通知
   - 在监控状态变化时显示通知

2. **快捷键**
   - 添加全局快捷键来显示/隐藏应用
   - 例如：Ctrl+Alt+N 显示应用

3. **自定义托盘菜单**
   - 在托盘菜单中显示监控状态
   - 快速启用/禁用监控

4. **最小化时暂停**
   - 最小化时自动暂停DNS监控
   - 恢复时自动继续监控
